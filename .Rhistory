library(boot)
results1 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data)
summary(results1)
summary.aov(results1)
results5 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data)
summary(results1)
summary.aov(results1)
vif(results5)
library(car)
vif(results5)
cor.test(x = KLRG1.D, y = SMALF1.d, data = data, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$SMALF1.d, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$SMALF1.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$SLAMF1.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$IFNG.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$CXCR5.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$IFNG.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$SLAMF1.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$CD69.D, method = "pearson")$estimate
cor.test(x = data$KLRG1.D, y = data$MKI67.D, method = "pearson")$estimate
cor.test(x = data$SLAMF1.D, y = data$IFNG.D, method = "pearson")$estimate
cor.test(x = data$SLAMF1.D, y = data$CXCR5.D, method = "pearson")$estimate
cor.test(x = data$SLAMF1.D, y = data$CD69.D, method = "pearson")$estimate
cor.test(x = data$SLAMF1.D, y = data$MKI67.D, method = "pearson")$estimate
cor.test(x = data$IFNG.D, y = data$CXCR5.D, method = "pearson")$estimate
cor.test(x = data$IFNG.D, y = data$CD69.D, method = "pearson")$estimate
cor.test(x = data$IFNG.D, y = data$MKI67.D, method = "pearson")$estimate
cor.test(x = data$CXCR5.D, y = data$MKI67.D, method = "pearson")$estimate
cor.test(x = data$CXCR5.D, y = data$CD69.D, method = "pearson")$estimate
cor.test(x = data$CD69.D, y = data$MKI67.D, method = "pearson")$estimate
View(results4)
install.packages("MANOVA.RM")
library(MANOVA.RM)
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
plot(cr, col = 6, lty = 6)
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
install.packages("HSAUR3")
if (requireNamespace("HSAUR3", quitely = TRUE)) {
library(HSAUR3)
data = data
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
plot(cr)
}
if (requireNamespace("HSAUR3", quitely = TRUE)) {
library(HSAUR3)
data = data
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
plot(cr)
}
if (requireNamespace("HSAUR3")) {
library(HSAUR3)
data = data
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
plot(cr)
}
if (requireNamespace("HSAUR3")) {
library(HSAUR3)
data = data
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
cr
plot(cr)
}
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
cr <- conf.reg(test)
test <- MANOVA.wide(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, iter = 1000, resampling = "paramBS")
summary(test)
results5 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(resultS5, test = "Wilks")
results5 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(results5, test = "Wilks")
install.packages("heplots")
cov_matrix <- summary(results5)$SS["Residuals"] / results5$df.residual
results3 <- lda(Group ~ IFNG.D + CD69.D , data = data) #+ SLAMF1.D + CXCR5.D + MKI67.D
library(MASS)
library(lattice)
results3 <- lda(Group ~ IFNG.D + CD69.D , data = data) #+ SLAMF1.D + CXCR5.D + MKI67.D
results3
plot(results3)
results5 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(results5)
results5 <- manova(cbind(KLRG1.D, IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(results5)
summary.aov(results5)
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D, data = data)
results3
plot(results3)
table(data$Group,predict(results3)$class)
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D + CD69.D, data = data)
results3
plot(results3)
table(data$Group,predict(results3)$class)
table(data$Group,predict(results3)$class)
results4 <- princomp(~IFNG.D + CXCR5.D + CD69.D + MKI67.D, data = data)
summary(results4)
results4$loadings
autoplot(results4, data = data , colour = "Group")
results5 <- manova(cbind(IFNG.D, SLAMF1.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(results5)
summary.aov(results5)
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D + CD69.D + KLRG1, data = data)
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D + CD69.D + KLRG1.D, data = data)
results3
plot(results3)
results <- lda(BVDV ~ IFNG.D + SLAMF1.D + CXCR5.D + CD69.D + MKI67.D + KLRG1.D, data = data)
results
results2 <- lda(Pregnant ~ IFNG.D + SLAMF1.D + CXCR5.D + CD69.D + MKI67.D + KLRG1.D, data = data)
results2
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D + CD69.D + KLRG1.D, data = data)
results3
plot(results3)
table(data$Group,predict(results3)$class)
results4 <- princomp(~IFNG.D + CXCR5.D + CD69.D + MKI67.D + KLRG1, data = data)
results4 <- princomp(~IFNG.D + CXCR5.D + CD69.D + MKI67.D + KLRG1.D, data = data)
summary(results4)
results4$loadings
splom(~data.frame(KLRG1.D,IFNG.D,CXCR5.D,CD69.D,SLAMF1.D,MKI67.D), data = data, groups = Group)
splom(~data.frame(KLRG1.D,IFNG.D,CXCR5.D,CD69.D,MKI67.D), data = data, groups = Group)
autoplot(results4, data = data , colour = "Group")
library(ggplot2)
library(ggfortify)
autoplot(results4, data = data , colour = "Group")
plot(results3)
results3 <- lda(Group ~ IFNG.D + MKI67.D + CXCR5.D + CD69.D, data = data)
results3
plot(results3)
splom(~data.frame(KLRG1.D,IFNG.D,CXCR5.D,CD69.D,MKI67.D), data = data, groups = Group)
autoplot(results4, data = data , colour = "Group")
autoplot(results4, data = data , colour = "Group")
results4 <- princomp(~IFNG.D + CXCR5.D + CD69.D + MKI67.D, data = data)
summary(results4)
autoplot(results4, data = data , colour = "Group")
results5 <- manova(cbind(KLRG1.D, IFNG.D, CXCR5.D, CD69.D, MKI67.D) ~ as.factor(Group), data = data, )
summary(results5)
summary.aov(results5)
cov_matrix <- summary(results5)$SS["Residuals"] / results5$df.residual
cov_matrix <- summary(results5)$SS["Residuals"] / results5$df.residual
install.packages("quartro")
install.packages("tidyverse")
install.packages("palmerpenguins")
install.packages("quarto")
install.packages("RSQLite")
library(RSQLite)
conn <- dbConnect(RSQLite::SQLite(), "example.db")
library(RSQLite)
conn <- dbConnect(RSQLite::SQLite(), "example.db")
conn <- dbConnect(RSQLite::SQLite(), "example.db")
View(conn)
if (Table1 == -1){
cat ("An error has occurred.\n")
msg <- odbcGetErrMsg(conn)
print (msg)
} else {
cat ("Table was created successfully.\n")
}
if (Table1 == -1){
cat ("An error has occurred.\n")
msg <- odbcGetErrMsg(conn)
print (msg)
} else {
cat ("Table was created successfully.\n")
}
Table1 <- dbExecute(conn,
"CREATE TABLE Customers (
customer_id INTEGER NOT NULL ,
country_name VARCHAR(20) NOT NULL,
country_code VARCHAR(20) NOT NULL
)",
errors=FALSE
)
if (Table1 == -1){
cat ("An error has occurred.\n")
msg <- odbcGetErrMsg(conn)
print (msg)
} else {
cat ("Table was created successfully.\n")
}
insert_data_query <- "
INSERT INTO Customers (customer_id, country_name, country_code) VALUES
(101, 'United Kingdom', 'UK'),
(101, 'United Kingdom', 'UK'),
(102, 'Canada', 'CA'),
(102, 'Canada', 'CA'),
(101, 'United Kingdom', 'UK'),
(103, 'Mexico', 'MX'),
(104, 'Malaysia', 'MY'),
(104, 'Malaysia', 'MY'),
(101, 'United Kingdom', 'UK'),
(105, 'Norway', 'NO'),
(105, 'Norway', 'NO');"
dbExecute(conn, insert_data_query)
head Table1
head(Table1)
tables <- dbListTables(conn)
print(tables)
dbGetQuery(conn, "SELECT * FROM Customers")
dbExecute(conn, "UPDATE Customers SET country_name = 'Britain' WHERE country_code = 'UK';")
dbGetQuery(conn, "SELECT * FROM Customers")
dbExecute(conn, "DELETE FROM Customers WHERE country_name = 'Britain';")
dbGetQuery(conn, "SELECT * FROM Customers")
dbDisconnect(conn)
setwd("~/GitHub/Clinical-Trial-Analytics---ML-Pipeline")
library(caret)
install.packages("caret")
install.packages("pROC")
install.packages("PRROC")
library(caret)
library(pROC)
library(PRROC)
library(caret)
library(pROC)
library(PRROC)
set.seed(123)
train_idx <- createDataPartition(
baseline_df$responder_30pct,
p = 0.8,
list = FALSE
)
conn <- dbConnect(SQLite(), "clinical_trial.db")
library(caret)
library(pROC)
library(PRROC)
library(SQLite)
library(caret)
library(pROC)
library(PRROC)
library(RSQLite)
conn <- dbConnect(SQLite(), "clinical_trial.db")
patients <- dbGetQuery(conn, "SELECT * FROM patients;")
# sites    <- dbGetQuery(conn, "SELECT * FROM sites;")
outcomes <- dbGetQuery(conn, "SELECT * FROM outcomes;")
# visits <- dbGetQuery(conn, "SELECT * FROM visits")
baseline_df <- patients %>%
inner_join(
outcomes %>% select(patient_id, responder_30pct),
by = "patient_id"
)
library(caret)
library(pROC)
library(PRROC)
library(RSQLite)
library(DBI)
conn <- dbConnect(SQLite(), "clinical_trial.db")
patients <- dbGetQuery(conn, "SELECT * FROM patients;")
# sites    <- dbGetQuery(conn, "SELECT * FROM sites;")
outcomes <- dbGetQuery(conn, "SELECT * FROM outcomes;")
# visits <- dbGetQuery(conn, "SELECT * FROM visits")
baseline_df <- patients %>%
inner_join(
outcomes %>% select(patient_id, responder_30pct),
by = "patient_id"
)
library(caret)
library(pROC)
library(PRROC)
library(RSQLite)
library(dplyr)
conn <- dbConnect(SQLite(), "clinical_trial.db")
patients <- dbGetQuery(conn, "SELECT * FROM patients;")
# sites    <- dbGetQuery(conn, "SELECT * FROM sites;")
outcomes <- dbGetQuery(conn, "SELECT * FROM outcomes;")
# visits <- dbGetQuery(conn, "SELECT * FROM visits")
baseline_df <- patients %>%
inner_join(
outcomes %>% select(patient_id, responder_30pct),
by = "patient_id"
)
baseline_df <- baseline_df %>%
select(
responder_30pct,
treatment_arm,
sex,
age,
bmi,
smoker,
comorbidity_count,
baseline_severity,
crp_mgL,
alt_U_L,
egfr_ml_min,
self_reported_adherence
)
set.seed(123)
train_idx <- createDataPartition(
baseline_df$responder_30pct,
p = 0.8,
list = FALSE
)
train_df <- baseline_df[train_idx, ]
test_df  <- baseline_df[-train_idx, ]
prop.table(table(baseline_df$responder_30pct))
prop.table(table(train_df$responder_30pct))
prop.table(table(test_df$responder_30pct))
prop.table(table(baseline_df$responder_30pct))
prop.table(table(train_df$responder_30pct))
prop.table(table(test_df$responder_30pct))
conn <- dbConnect(SQLite(), "clinical_trial.db")
patients <- dbGetQuery(conn, "SELECT * FROM patients;")
# sites    <- dbGetQuery(conn, "SELECT * FROM sites;")
outcomes <- dbGetQuery(conn, "SELECT * FROM outcomes;")
# visits <- dbGetQuery(conn, "SELECT * FROM visits")
baseline_df <- patients %>%
inner_join(
outcomes %>% select(patient_id, responder_30pct),
by = "patient_id"
)
baseline_df <- baseline_df %>%
select(
responder_30pct,
treatment_arm,
sex,
age,
bmi,
smoker,
comorbidity_count,
baseline_severity,
crp_mgL,
alt_U_L,
egfr_ml_min,
self_reported_adherence
)
set.seed(123)
train_idx <- createDataPartition(
baseline_df$responder_30pct,
p = 0.8,
list = FALSE
)
train_df <- baseline_df[train_idx, ]
test_df  <- baseline_df[-train_idx, ]
train_df$sex <- factor(train_df$sex)
test_df$sex  <- factor(test_df$sex,
levels = levels(train_df$sex))
train_df$treatment_arm <- factor(train_df$treatment_arm)
test_df$treatment_arm  <- factor(test_df$treatment_arm,
levels = levels(train_df$treatment_arm)
)
prop.table(table(baseline_df$responder_30pct))
prop.table(table(train_df$responder_30pct))
prop.table(table(test_df$responder_30pct))
model_a <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
baseline_severity +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence +
treatment_arm,
family=binomial(link='logit'),
data=train_df)
summary(model_a)
# model_a - baseline_severity
model_b <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence +
treatment_arm,
family=binomial(link='logit'),
data=train_df)
summary(model_b)
# objective labs only
model_c <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
crp_mgL +
alt_U_L +
egfr_ml_min,
family=binomial(link='logit'),
data=train_df)
summary(model_c)
# model_c + demographics
model_d <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
baseline_severity +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence +
treatment_arm,
family=binomial(link='logit'),
data=train_df)
summary(model_d)
# model_c + demographics
model_d <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence +
treatment_arm,
family=binomial(link='logit'),
data=train_df)
summary(model_d)
# model_c + demographics
model_d <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence +
family=binomial(link='logit'),
# model_c + demographics
model_d <- glm(formula = responder_30pct ~
as.factor(sex) +
age +
bmi +
smoker +
comorbidity_count +
crp_mgL +
alt_U_L +
egfr_ml_min +
self_reported_adherence,
family=binomial(link='logit'),
data=train_df)
summary(model_d)
test_pred_prob <- predict(model_a, newdata = test_df, type = "response")
summary(test_pred_prob)
head(test_pred_prob)
roc_obj <- roc(
response = test_df$responder_30pct,
predictor = test_pred_prob
)
auc(roc_obj)
pr_obj <- pr.curve(
scores.class0 = test_pred_prob[test_df$responder_30pct == 1],
scores.class1 = test_pred_prob[test_df$responder_30pct == 0],
curve = TRUE
)
pr_obj$auc.integral
test_pred_prob <- predict(model_b, newdata = test_df, type = "response")
summary(test_pred_prob)
head(test_pred_prob)
roc_obj <- roc(
response = test_df$responder_30pct,
predictor = test_pred_prob
)
auc(roc_obj)
pr_obj <- pr.curve(
scores.class0 = test_pred_prob[test_df$responder_30pct == 1],
scores.class1 = test_pred_prob[test_df$responder_30pct == 0],
curve = TRUE
)
pr_obj$auc.integral
test_pred_prob <- predict(model_c, newdata = test_df, type = "response")
summary(test_pred_prob)
head(test_pred_prob)
roc_obj <- roc(
response = test_df$responder_30pct,
predictor = test_pred_prob
)
auc(roc_obj)
pr_obj <- pr.curve(
scores.class0 = test_pred_prob[test_df$responder_30pct == 1],
scores.class1 = test_pred_prob[test_df$responder_30pct == 0],
curve = TRUE
)
pr_obj$auc.integral
test_pred_prob <- predict(model_d, newdata = test_df, type = "response")
summary(test_pred_prob)
head(test_pred_prob)
roc_obj <- roc(
response = test_df$responder_30pct,
predictor = test_pred_prob
)
auc(roc_obj)
pr_obj <- pr.curve(
scores.class0 = test_pred_prob[test_df$responder_30pct == 1],
scores.class1 = test_pred_prob[test_df$responder_30pct == 0],
curve = TRUE
)
pr_obj$auc.integral
